<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>Evento Musical Nº8</title>

  <!-- PWA: manifest y meta -->
  <link rel="manifest" href="manifest.json" />
  <meta name="theme-color" content="#121212" />
  <meta name="mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <link rel="apple-touch-icon" href="icon-192.png" />

  <link href="https://fonts.googleapis.com/css?family=Metal+Mania:400|Roboto:400,700&display=swap" rel="stylesheet" />
  <style>
    body, html { margin:0; padding:0; font-size:16px; background:#121212; color:#eee; -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale; font-family:"Roboto", Arial, sans-serif;}
    .pantalla-inicio {display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:100vh;background:linear-gradient(135deg,#1b1b1b 80%,#660909 100%);position:fixed;inset:0;z-index:9999;padding:20px;box-sizing:border-box;text-align:center;}
    .pantalla-inicio h1 {font-family:"Metal Mania",cursive,Arial,sans-serif;font-size:2.2em;margin-bottom:18px;text-shadow:0 4px 20px #d02121,1px 1px 0 #000;color:#fff;}
    .pantalla-inicio button {background:#d02121;color:#fff;border:none;border-radius:10px;font-size:1.3em;padding:14px 28px;font-family:"Metal Mania",Arial,sans-serif;cursor:pointer;transition:background 0.2s;}
    .pantalla-inicio button:hover {background:#960909;}
    header {background:linear-gradient(90deg,#222 80%,#a00 100%);box-shadow:0 4px 18px rgba(100,0,0,0.4);border-bottom:3px solid #d02121;padding:15px 20px;display:flex;align-items:center;justify-content:center;position:sticky;top:0;z-index:1100;}
    header h1 {font-family:"Metal Mania",cursive,Arial,sans-serif;font-size:1.8em;letter-spacing:1px;user-select:none;margin:0;flex-grow:1;padding-left:50px;color:#fff;text-shadow:0 4px 22px #d02121,1px 1px 0 #000;}
    .menu-hamburguesa {position:absolute;left:10px;top:50%;transform:translateY(-50%);z-index:1101;}
    .hamburguesa-btn {display:flex;flex-direction:column;justify-content:center;width:36px;height:36px;background:none;border:none;cursor:pointer;padding:0;z-index:1101;}
    .hamburguesa-bar {width:28px;height:3px;background:#fff;border-radius:2px;margin:5px 0;transition:0.3s;}
    .menu-navegacion {display:none;position:fixed;top:0;left:0;height:100vh;width:85vw;max-width:320px;padding-top:65px;background:#2a1a1a;box-shadow:4px 0 24px rgba(48,6,6,0.85);flex-direction:column;gap:16px;z-index:1100;overflow-y:auto;user-select:none;transition:transform 0.3s ease;box-sizing:border-box;}
    .menu-navegacion.show {display:flex;}
    .menu-navegacion button {font-family:"Metal Mania",Arial,sans-serif;font-size:1.2em;color:#fff;background:transparent;border:none;padding:16px 20px;text-align:left;border-bottom:1px solid #aa2b2b;cursor:pointer;transition:background 0.2s,color 0.18s;}
    .menu-navegacion button:hover, .menu-navegacion button:focus {background:#bf1f1f;outline:none;color:#fff;}
    section {max-width:100%;margin:20px 10px;padding:18px 16px;border-radius:12px;background:#330a0a;box-shadow:0 5px 25px rgba(160,18,22,0.3);display:none;animation:fadeIn 0.7s;box-sizing:border-box;}
    section.active {display:block;}
    section h2 {font-family:"Metal Mania",cursive,Arial,sans-serif;font-size:1.5em;color:#d02121;margin-top:0;margin-bottom:20px;text-shadow:0 1px 13px #a31634,1px 1px 0 #222;border-bottom:2px solid #d02121;padding-bottom:6px;}
    section p, section label, section textarea, section input, section select {font-family:"Roboto",Arial,sans-serif;font-size:1em;line-height:1.6;color:#eee;}
    input, textarea, select {margin:5px 0 13px 0;padding:10px 14px;width:100%;border:1.5px solid #b62222;border-radius:8px;background:#221010;color:#eee;font-size:1em;box-shadow:inset 0 1px 6px #b52323;transition:border 0.2s,box-shadow 0.2s;box-sizing:border-box;}
    input:focus, textarea:focus, select:focus {border-color:#fff;box-shadow:0 0 10px #ff4f4f;outline:none;}
    button, input[type="submit"] {background:#d02121;color:#fff;border:none;border-radius:10px;box-shadow:0 3px 16px #e44141cc;font-size:1.1em;letter-spacing:1.2px;font-family:"Metal Mania",Arial,sans-serif;padding:12px 0;cursor:pointer;margin-top:6px;width:100%;transition:all 0.22s;box-sizing:border-box;}
    button:hover, input[type="submit"]:hover, button:focus, input[type="submit"]:focus {background:#fff;color:#d02121;border:1.5px solid #d02121;box-shadow:0 5px 24px #e04242cc;outline:none;}
    #respuestasConsultorio ul {padding-left:1.5em;}
    #respuestasConsultorio li {margin-bottom:10px;word-wrap:break-word;}
    #resultado-libro, #resultado-pelicula, #resultado-diccionario {display:inline-block;margin-left:10px;vertical-align:middle;word-wrap:break-word;max-width:80vw;color:#fff;}
    .libro-item {display:flex;gap:10px;flex-wrap:wrap;color:#fff;}
    .autor {font-weight:bold;min-width:120px;color:#f5bcbc;}
    .titulo {font-style:italic;color:#f0dcdc;}
    @keyframes fadeIn {from {opacity:0; transform:translateY(20px);} to {opacity:1; transform:translateY(0);}}
    .overlay {position:fixed;inset:0;width:100%;height:100%;background:rgba(0,0,0,0.75);display:none;justify-content:center;align-items:center;padding:10px;box-sizing:border-box;z-index:9998;}
    .overlay.show {display:flex;}
    .modal {background:#2a1a1a;color:#eee;padding:20px 16px;border-radius:16px;max-width:95%;max-height:70vh;overflow-y:auto;box-shadow:0 10px 30px rgba(0,0,0,0.7);position:relative;box-sizing:border-box;animation:modalFade 0.24s ease-out;}
    .modal button.cerrar {width:30px;height:30px;padding:0;line-height:30px;text-align:center;position:absolute;top:10px;right:10px;background:none;border:none;color:#fff;font-size:22px;cursor:pointer;z-index:10;}
    .modal h3, .modal h2 {padding-right:50px;margin-top:0;margin-bottom:16px;position:relative;z-index:1;color:#eee;word-break:break-word;}
    @keyframes modalFade {from {transform:scale(0.96);opacity:0;} to {transform:scale(1);opacity:1;}}
    @media(max-width:480px){.pantalla-inicio h1{font-size:1.8em;}header h1{font-size:1.4em;padding-left:45px;}.menu-hamburguesa{left:5px;}.hamburguesa-btn{width:32px;height:32px;}.hamburguesa-bar{width:24px;height:3px;margin:4px 0;}}
  </style>
</head>
<body>
  <div class="pantalla-inicio" id="pantallaInicio">
    <h1>Evento Musical Nº8</h1>
    <button id="btnEntrar">Entrar / Registrarse</button>
    <button id="btnInvitado">Invitado</button>
  </div>

  <div class="overlay" id="overlayLogin">
    <div class="modal" id="modalLogin">
      <button class="cerrar" id="cerrarModal">&times;</button>
      <h2>Acceso a la web</h2>
      <input type="text" id="usuarioLogin" placeholder="Usuario" />
      <input type="password" id="claveLogin" placeholder="Clave" />
      <button id="btnLogin">Entrar</button>
      <hr style="border-color:#d02121;" />
      <h3>Registrarse</h3>
      <input type="text" id="usuarioReg" placeholder="Nuevo usuario" />
      <input type="password" id="claveReg" placeholder="Nueva clave" />
      <button id="btnRegistrar">Registrarse</button>
      <p id="mensajeLogin" style="color:#ff6666;margin-top:12px;"></p>
    </div>
  </div>

  <header>
    <h1>Evento Musical Nº8</h1>
    <div id="usuarioActivo" style="position:absolute;right:20px;color:#fff;font-weight:bold;"></div>
  </header>

  <nav class="menu-navegacion" id="menuNav">
    <button onclick="mostrarSeccion('diccionario')">Diccionario</button>
    <button onclick="mostrarSeccion('consultorio')">Consultorio</button>
    <button onclick="mostrarSeccion('peliculas')">Películas</button>
    <button onclick="mostrarSeccion('libros')">Libros</button>
  </nav>

  <section id="diccionario">
    <h2>Diccionario</h2>
    <div id="resultado-diccionario"></div>
  </section>

  <section id="consultorio">
    <h2>Consultorio</h2>
    <div id="respuestasConsultorio"></div>
  </section>

  <section id="peliculas">
    <h2>Películas</h2>
    <div id="resultado-pelicula"></div>
  </section>

  <section id="libros">
    <h2>Libros</h2>
    <div id="resultado-libro"></div>
  </section>

  <script>
    const GAS_URL = "https://script.google.com/macros/s/AKfycbz1MP4PE4RbtkMcZqe1WYceiPyeVYR3KS84NhEwJss0JKlNN5PWzmmVjJAm4oD3iSlGPw/exec";

    // POPUP LOGIN
    const overlay = document.getElementById("overlayLogin");
    const modal = document.getElementById("modalLogin");
    const btnEntrar = document.getElementById("btnEntrar");
    const btnInvitado = document.getElementById("btnInvitado");
    const cerrarModal = document.getElementById("cerrarModal");
    const mensajeLogin = document.getElementById("mensajeLogin");
    const usuarioActivo = document.getElementById("usuarioActivo");

    let usuarioActual = localStorage.getItem("usuarioActual") || null;

    function abrirModal() { overlay.classList.add("show"); }
    function cerrar() { overlay.classList.remove("show"); mensajeLogin.textContent=""; }

    btnEntrar.addEventListener("click", abrirModal);
    cerrarModal.addEventListener("click", cerrar);
    btnInvitado.addEventListener("click", () => {
      usuarioActual = "Invitado";
      usuarioActivo.textContent = usuarioActual;
      document.getElementById("pantallaInicio").style.display = "none";
    });

    function login() {
      const usuario = document.getElementById("usuarioLogin").value.trim();
      const clave = document.getElementById("claveLogin").value.trim();
      fetch(`${GAS_URL}?action=login&usuario=${encodeURIComponent(usuario)}&clave=${encodeURIComponent(clave)}`, { method:"POST" })
        .then(res => res.json())
        .then(data => {
          if(data.status==="OK"){
            usuarioActual = data.usuario;
            localStorage.setItem("usuarioActual", usuarioActual);
            usuarioActivo.textContent = usuarioActual;
            cerrar();
            document.getElementById("pantallaInicio").style.display = "none";
          } else { mensajeLogin.textContent = data.message; }
        });
    }

    function registrar() {
      const usuario = document.getElementById("usuarioReg").value.trim();
      const clave = document.getElementById("claveReg").value.trim();
      fetch(`${GAS_URL}?action=register&usuario=${encodeURIComponent(usuario)}&clave=${encodeURIComponent(clave)}`, { method:"POST" })
        .then(res => res.json())
        .then(data => {
          if(data.status==="OK"){
            mensajeLogin.style.color = "#66ff66";
            mensajeLogin.textContent = "Usuario registrado correctamente. Ahora haz login.";
          } else { mensajeLogin.style.color = "#ff6666"; mensajeLogin.textContent = data.message; }
        });
    }

    document.getElementById("btnLogin").addEventListener("click", login);
    document.getElementById("btnRegistrar").addEventListener("click", registrar);

    if(usuarioActual) {
      usuarioActivo.textContent = usuarioActual;
      document.getElementById("pantallaInicio").style.display = "none";
    }

    // NAVEGACION
    const menuBtn = document.querySelector(".hamburguesa-btn");
    const menuNav = document.getElementById("menuNav");
    menuBtn?.addEventListener("click", ()=>menuNav.classList.toggle("show"));

    function mostrarSeccion(id){
      document.querySelectorAll("section").forEach(s=>s.classList.remove("active"));
      document.getElementById(id).classList.add("active");
      menuNav.classList.remove("show");
    }
  </script>
</body>
</html>
