<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Evento Musical Nº8</title>
<link href="https://fonts.googleapis.com/css?family=Metal+Mania:400|Roboto:400,700&display=swap" rel="stylesheet">
<style>
body { font-family: 'Roboto', Arial, sans-serif; background: linear-gradient(135deg, #18191a 75%, #330505 100%); color:#f4f4f4; margin:0; padding:0; min-height:100vh; }
header { background: linear-gradient(90deg,#1a1a1a 70%, #960909 100%); padding:26px 0 18px 0; text-align:center; box-shadow:0 6px 32px rgba(80,0,0,0.16); border-bottom:4px solid #c10d0d; margin-bottom:0; position:relative; }
header h1 { font-family: 'Metal Mania', cursive, Arial, sans-serif; margin:0; font-size:2.8em; color:#fff; letter-spacing:1.5px; text-shadow:0 4px 22px #d02121,1px 1px 0 #000; }
nav { margin-top:16px; margin-bottom:-5px; }
nav button { font-family: 'Metal Mania', Arial, sans-serif; font-size:1.1em; background:#300606; color:#fff; border:1px solid #aa2b2b; border-radius:22px; margin:0 8px; padding:10px 22px; cursor:pointer; transition:background 0.2s,color 0.18s,border 0.15s; box-shadow:0 2px 10px #d6262699; outline:none; }
nav button:hover, nav button:active { background:#c10d0d; color:#fff; border:1.5px solid #c10d0d; box-shadow:0 5px 20px #fa757599; }
section { padding:27px 24px; border-bottom:1px solid #201113; border-radius:10px; background:rgba(26,19,19,0.83); max-width:700px; margin:28px auto 33px auto; box-shadow:0 7px 40px rgba(145,15,15,0.095); display:none; animation:fadeIn 0.7s; }
section.active { display:block; }
section h2 { font-family: 'Metal Mania', cursive, Arial, sans-serif; color:#d02121; font-size:2em; margin-top:0; text-shadow:0 1px 13px #a31634,1px 1px 0 #222; border-bottom:1.5px solid #d02121; padding-bottom:7px; margin-bottom:23px; }
section p, section label, section textarea, section input, section select { font-family: 'Roboto', Arial, sans-serif; font-size:1em; line-height:1.6; }
input, textarea, select { margin:5px 0 13px 0; padding:7px 9px; width:100%; border:1.8px solid #a21221; border-radius:6px; background:#211111; color:#fff; font-size:1em; font-family:'Roboto', Arial, sans-serif; box-shadow:0 2px 7px #d01e3dad inset; transition:border .2s, box-shadow .2s; }
input:focus, textarea:focus, select:focus { border:2px solid #fff; box-shadow:0 0 12px #e04242cc; outline:none; }
button, input[type='submit'] { background:#d02121; color:#fff; border:none; border-radius:7px; box-shadow:0 2px 14px #e04242cc; font-size:1.1em; letter-spacing:1.2px; font-family:'Metal Mania', Arial, sans-serif; padding:12px 24px; cursor:pointer; margin-top:6px; transition:all 0.22s; }
button:hover, input[type='submit']:hover { background:#fff; color:#d02121; border:1.5px solid #d02121; box-shadow:0 5px 24px #e04242cc; }
#respuestasConsultorio ul { padding-left:1.5em; }
#respuestasConsultorio li { margin-bottom:10px; }
#resultado-libro { display:inline-block; margin-left:10px; }
.libro-item { display:flex; gap:10px; }
.autor { font-weight:bold; min-width:200px; }
.titulo { font-style:italic; }
@keyframes fadeIn { from { opacity:0; transform:translateY(20px);} to { opacity:1; transform:translateY(0);} }

/* --- Modal Libros --- */
#overlay-libro{
  position:fixed; inset:0; width:100%; height:100%;
  background:rgba(0,0,0,.7);
  display:none; justify-content:center; align-items:center;
  z-index:9998;
}
#ventana-derecha-libro{
  background:#1c1c1c; color:#fff;
  padding:20px; border-radius:16px;
  max-width:90%; width:400px; max-height:80%;
  overflow-y:auto; position:relative;
  box-shadow:0 8px 25px rgba(0,0,0,.6);
  display:none; z-index:9999;
  animation:modalFade .24s ease-out;
}
#ventana-derecha-libro button.cerrar{
  position:absolute; top:12px; right:14px;
  background:none; border:none; color:#fff;
  font-size:22px; cursor:pointer;
}
@keyframes modalFade{
  from{ transform:scale(.96); opacity:0; }
  to{ transform:scale(1); opacity:1; }
}
@media (max-width:768px){
  #overlay-libro{ align-items:flex-end; }
  #ventana-derecha-libro{
    width:100%; max-width:100%;
    height:70%; max-height:70%;
    border-radius:16px 16px 0 0;
    animation:slideUp .28s ease-out;
  }
  @keyframes slideUp{
    from{ transform:translateY(100%); opacity:0; }
    to{ transform:translateY(0); opacity:1; }
  }
}
</style>
</head>
<body>

<header>
<h1>EVENTO MUSICAL Nº8</h1>
<nav>
  <button onclick="mostrarSeccion('musica')">Música</button>
  <button onclick="mostrarSeccion('libros')">Libros</button>
  <button onclick="mostrarSeccion('cine')">Cine</button>
  <button onclick="mostrarSeccion('diccionario')">Diccionario</button>
  <button onclick="mostrarSeccion('consultorio')">Consultorio</button>
  <button onclick="mostrarSeccion('Follar')">Follar</button>
</nav>
</header>

<section id="musica" class="active">
<h2>Música</h2>
<p>Hartos de tanta mierda como nos meten por los ojos, oídos y demás orificios, Evento Musical Nº8 se ha tomado la molestia de seleccionar 1000 canciones de Rock. La excelencia en la selección ha sido exquisita.</p>
<button onclick="propuestaMusical()">Propuesta Musical</button>
</section>

<section id="libros">
<h2>Libros</h2>
<p>Sección de libros. Posible búsqueda aleatoria entre libros almacenados en libros.txt.</p>
<button id="buscar-libro-btn">Buscar libro</button>
<div id="resultado-libro"></div>
</section>

<section id="cine">
<h2>Cine</h2>
<p>Sección de cine. Búsqueda aleatoria de películas del fichero peliculas.txt.</p>
<button id="propuesta-pelicula-btn">Propuesta de película</button>
<div id="resultado-pelicula"></div>
</section>

<section id="diccionario">
<h2>Diccionario Mongoplédico</h2>
<button onclick="verDiccionario()">Ver diccionario</button>
<button onclick="añadirPalabra()">Añadir palabra</button>
</section>

<section id="consultorio">
  <h2>Consultorio</h2>
  <form id="formConsultorio" onsubmit="enviarConsultorio(event)" autocomplete="off">
    <label>Nombre:</label>
    <input type="text" name="nombre" id="nombre" required>
    <label>Email:</label>
    <input type="email" name="email" id="email" required>
    <label>Consulta:</label>
    <textarea name="consulta" id="consulta" rows="5" required></textarea>
    <button type="submit" id="submitBtn">Enviar Consulta</button>
  </form>
  <div id="respuestasConsultorio">
    <h3>Consultas recibidas</h3>
    <ul id="listaConsultas"></ul>
  </div>
</section>

<section id="Follar">
<h2>Consentimiento</h2>
<p>Documento de consentimiento según Ley Orgánica 10/2022.</p>
<button onclick="window.open('consentimiento.html', '_blank')">Abrir Documento de Consentimiento</button>
</section>

<!-- Overlay + Modal Libros -->
<div id="overlay-libro" onclick="cerrarModal()">
  <div id="ventana-derecha-libro" onclick="event.stopPropagation()">
    <button class="cerrar" onclick="cerrarModal()">✖</button>
    <div id="contenido-libro"></div>
  </div>
</div>

<script>
/* --- Mostrar Sección --- */
function mostrarSeccion(id){
  document.querySelectorAll('section').forEach(sec => sec.classList.remove('active'));
  document.getElementById(id).classList.add('active');
}

/* --- Propuesta Musical --- */
function propuestaMusical() {
  fetch('canciones.txt')
    .then(r=>r.text())
    .then(data=>{
      const lineas=data.split('\n').filter(l=>l.trim()!=='');
      const random=lineas[Math.floor(Math.random()*lineas.length)];
      const partes=random.split('\t');
      const artista=partes[0], cancion=partes[1];
      const query=encodeURIComponent(artista+' '+cancion);
      window.open('https://www.youtube.com/results?search_query='+query,'_blank');
    })
    .catch(err=>alert('No se pudo cargar la lista de canciones: '+err));
}

/* --- Búsqueda de libros --- */
document.getElementById('buscar-libro-btn').addEventListener('click', async () => {
  const resultado = document.getElementById('resultado-libro');
  resultado.innerHTML = 'Cargando...';
  const contenido = document.getElementById('contenido-libro');

  try {
    const response = await fetch('libros.txt');
    if(!response.ok) throw new Error('No se pudo cargar el archivo');
    const texto = await response.text();
    const libros = texto.split('\n').filter(l=>l.trim()!=='');
    const libroAleatorio = libros[Math.floor(Math.random()*libros.length)];
    const partes = libroAleatorio.split('\t');
    const autor = partes[0] || '';
    const titulo = partes[1] || '';
    const sinopsisLocal = partes[2] || 'Sinopsis no disponible';
    const bioLocal = partes[3] || 'Bio del autor no disponible';

    resultado.innerHTML = `<div class="libro-item"><span class="autor">${autor}</span> - <span class="titulo">${titulo}</span></div>`;
    contenido.innerHTML = `<h3>${titulo}</h3>
        <p><strong>Autor:</strong> ${autor}</p>
        <p><strong>Sinopsis:</strong> ${sinopsisLocal}</p>
        <p><strong>Bio:</strong> ${bioLocal}</p>`;
    abrirModal();
  } catch(err){
    resultado.textContent='Error al cargar el libro';
    console.error(err);
  }
});

/* --- Modal Libros --- */
function abrirModal(){
  document.getElementById('overlay-libro').style.display='flex';
  document.getElementById('ventana-derecha-libro').style.display='block';
}
function cerrarModal(){
  document.getElementById('overlay-libro').style.display='none';
  document.getElementById('ventana-derecha-libro').style.display='none';
}

/* --- Cine --- */
document.getElementById('propuesta-pelicula-btn').addEventListener('click', async ()=>{
  const resultado = document.getElementById('resultado-pelicula');
  resultado.textContent='Cargando...';
  try{
    const response = await fetch('peliculas.txt');
    if(!response.ok) throw new Error('No se pudo cargar el archivo');
    const lineas = (await response.text()).split('\n').filter(l=>l.trim()!=='');
    const aleatoria = lineas[Math.floor(Math.random()*lineas.length)];
    const partes = aleatoria.split('\t');
    const titulo = partes[0], director = partes[1], resumen = partes[2];
    resultado.innerHTML=`<strong>${titulo}</strong> (${director})<br>${resumen}`;
  }catch(err){
    resultado.textContent='Error al cargar película';
    console.error(err);
  }
});

/* --- Diccionario Mongoplédico --- */
const DICCIONARIO_URL = 'https://script.google.com/macros/s/AKfycbxA8MlfFoBw4_6cV63NzWjDOWfwvGQBh6Et-r5wN2YCnngYgvVt0P8E8pjMR78emZ0CQQ/exec';

async function verDiccionario(){
  try{
    const resp = await fetch(DICCIONARIO_URL);
    const data = await resp.json();
    if(data.status==='OK'){
      const palabras = data.diccionario.map(d=>`${d.palabra}: ${d.descripcion}`).join('\n');
      const win = window.open('','_blank','width=600,height=400');
      win.document.write(`<pre>${palabras}</pre>`);
    }else{
      alert('Error cargando diccionario');
    }
  }catch(err){
    alert('Error al cargar diccionario');
  }
}

function añadirPalabra(){
  const palabra = prompt('Nueva palabra:');
  if(!palabra) return alert('Palabra vacía');
  const descripcion = prompt('Descripción:');
  if(!descripcion) return alert('Descripción vacía');

  const params = new URLSearchParams();
  params.append('palabra', palabra);
  params.append('descripcion', descripcion);

  fetch(DICCIONARIO_URL+'?'+params.toString(), { method:'POST' })
    .then(r=>r.json())
    .then(res=>{
      if(res.status==='OK') alert('Palabra añadida correctamente');
      else alert('Error al añadir palabra: '+res.message);
    })
    .catch(err=>alert('Error al añadir palabra: '+err));
}

/* --- Consultorio --- */
function enviarConsultorio(e){
  e.preventDefault();
  const nombre = document.getElementById('nombre').value.trim();
  const email = document.getElementById('email').value.trim();
  const consulta = document.getElementById('consulta').value.trim();
  if(!nombre || !email || !consulta){ alert('Rellena todos los campos'); return; }

  const li = document.createElement('li');
  li.textContent=`${nombre} (${email}): ${consulta}`;
  document.getElementById('listaConsultas').appendChild(li);
  e.target.reset();
}
</script>
</body>
</html>
